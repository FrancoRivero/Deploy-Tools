{
    "description": "Virtual Machine to building and testing a customize kernel",
    "variables": {
        "iso_url": "http/ISO_NAME",
        "iso_checksum": "ISO_CHECKSUM",
        "keep_registered": "true",
        "headless": "false",
        "vm_description": "FreeBSD 13 TEST",
        "vm_version": "1.0.0",

        "vm_name": "FreeBSD_for_testing",
        "disk_size": "80000",
        "memory": "4096",
        "cpus": "4",
        "vram": "64",

        "fullname": "FreeBSD-13",
        "username": "developer",
        "password": "dev12345"
    },
    "builders": [{
        "type": "virtualbox-iso",
        "guest_os_type": "FreeBSD_64",
        "http_directory": "http",
        "guest_additions_path": "VBoxGuestAdditions_{{.Version}}.iso",

        "output_directory": "{{user `output_path`}}/{{user `vm_name`}}",
        "export_opts": [
            "--manifest",
            "--vsys", "0",
            "--description", "{{user `vm_description`}}",
            "--version", "{{user `vm_version`}}"
        ],

        "iso_url": "{{user `iso_url`}}",
        "iso_checksum": "{{user `iso_checksum`}}",

        "ssh_username": "{{user `username`}}",
        "ssh_password": "{{user `password`}}",
        "ssh_port": 22,
        "ssh_wait_timeout": "10000s",

        "disk_size": "{{user `disk_size`}}",
        "vboxmanage": [
            ["modifyvm", "{{.Name}}", "--memory", "{{user `memory`}}"],
            ["modifyvm", "{{.Name}}", "--cpus", "{{user `cpus`}}"],
            ["modifyvm", "{{.Name}}", "--vram", "{{user `vram`}}"],
            ["modifyvm", "{{.Name}}", "--clipboard-mode", "bidirectional" ]
        ],
        "vm_name": "{{user `vm_name`}}",
        "keep_registered": "{{user `keep_registered`}}",
        "headless": "{{user `headless`}}",
        "boot_wait": "45s",
        "boot_command": [
            "I<wait>",
            "<enter><wait>",
            "<enter><wait>",
            "{{user `hostname`}}",
            "<enter><wait>",
            "k<spacebar><wait>",
            "<down><down><spacebar><wait>",
            "<enter><wait>",
            "<down><down><down>",
            "<enter><wait>",
            "<enter><wait>",
            "<enter><wait>", 
            "<spacebar><enter>",
            "<left>",
            "Y",
            "<wait10><wait10><wait10><wait10><wait10><wait10><wait10><wait10><wait10><wait10>",
            "vagrant<enter><wait>",
            "vagrant<enter><wait>",
            "<enter><wait>",
            "Y<wait>",
            "Y",
            "<wait10><wait10>",
            "Y<wait>",
            "Y",
            "<wait10><wait10>",
            "<enter><wait>",
            "a",
            "<enter><wait>",
            "<enter><wait>",
            "<enter><wait>",
            "<enter><wait>",
            "<enter><wait>",
            "<down><down><down><down>R<spacebar><wait>",
            "<down>I<spacebar><wait>",
            "<down>C<spacebar><wait>",
            "<down><spacebar><wait>",
            "<down><spacebar><wait>",
            "<enter><wait>",
            "Y<wait>",
            "{{user `username`}}",
            "<enter><wait>",
            "Vagrant User",
            "<enter><wait>",
            "<enter><wait>",
            "<enter><wait>",
            "wheel",
            "<enter><wait>",
            "<enter><wait>",
            "sh",
            "<enter><wait>",
            "/home/{{user `username`}}",
            "<enter><wait>",
            "0700",
            "<enter><wait>",
            "Y",
            "<enter><wait>",
            "N",
            "<enter><wait>",
            "N",
            "<enter><wait>",
            "{{user `passwor`}}",
            "<enter><wait>",
            "{{user `password`}}",
            "<enter><wait>",
            "N",
            "<enter><wait>",
            "Y",
            "<enter><wait>",
            "N",
            "<enter><wait>",
            "<enter>",
            "<wait10><wait10><wait10><wait10><wait10><wait10>",
            "<left>",
            "Y<wait>",
            "sed -i -e 's/^#PermitRootLogin no/PermitRootLogin yes/' /etc/ssh/sshd_config<enter><wait>",
            "echo 'autoboot_delay=\"{{user `autoboot_delay`}}\"' >> /boot/loader.conf<enter><wait>",
            "echo 'if_vmx_load=\"YES\"' >> /boot/loader.conf<enter><wait>",
            "chsh -s sh root<enter><wait>",
            "exit<enter><wait>",
            "R",
            "<wait10><wait10><wait10><wait10><wait10>"
        ],
        "shutdown_command": "echo '{{ user `password` }}'| sudo -S shutdown -P now"

    }],
    "provisioners": [{
            "type": "shell",
            "script": "dependencies_installers/install_VBGuestAdditions.sh",
            "execute_command": "echo '{{ user `password` }}' | {{.Vars}} sudo -S -E bash '{{.Path}}'"
    }]
}
